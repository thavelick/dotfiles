#!/usr/bin/env bash
# From https://codeberg.org/EvanHahn/dotfiles/src/branch/main/home/bin/bin/sfx
set -e
set -u
set -o pipefail

XDG_CONFIG_HOME=${XDG_CONFIG_HOME:-$HOME/.config}
SFX_DIR="$XDG_CONFIG_HOME/dotfiles-sfx"

# Show usage if no argument provided
if [ $# -eq 0 ] || [ "$1" = "--help" ] || [ "$1" = "-h" ]; then
  echo "Usage: sfx <sound>"
  echo ""
  echo "Available sounds:"
  if [ -d "$SFX_DIR" ]; then
    for file in "$SFX_DIR"/*.ogg; do
      if [ -f "$file" ]; then
        basename "$file" .ogg
      fi
    done | sort
  else
    echo "  (none - $SFX_DIR not found)"
  fi
  exit 1
fi

SOUND_FILE="$SFX_DIR/$1.ogg"

# Fall back to bell if sound file doesn't exist
if [ ! -f "$SOUND_FILE" ]; then
  echo "Warning: Sound '$1' not found, playing bell instead" >&2
  SOUND_FILE="$SFX_DIR/bell.ogg"
fi

exec mpv --really-quiet --no-video "$SOUND_FILE" &
