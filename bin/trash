#!/usr/bin/env bash
# Inspired by https://codeberg.org/EvanHahn/dotfiles/src/branch/main/home/bin/bin/trash
# Simplified to use mv instead of osascript/gio
set -e
set -u
set -o pipefail

if [[ "${1:-}" == "-h" ]] || [[ "${1:-}" == "--help" ]]; then
    cat <<EOF
Usage: trash <file|directory> [...]

Move files or directories to trash instead of permanently deleting them.

This is a safer alternative to 'rm' that moves items to a trash directory:
  - macOS: ~/.Trash
  - Linux: ~/.cache/trash

Multiple files can be trashed in a single command.

Examples:
  trash file.txt              - Move single file to trash
  trash file1.txt file2.txt   - Move multiple files to trash
  trash my_directory          - Move directory to trash
  trash *.tmp                 - Move all .tmp files to trash
EOF
    exit 0
fi

if [[ $# -lt 1 ]]; then
    echo "Usage: trash <file|directory> [...]" >&2
    exit 1
fi

if [[ "$(uname)" == 'Darwin' ]]; then
  trash_dir="$HOME/.Trash"
else
  trash_dir="$HOME/.cache/trash"
  mkdir -p "$trash_dir"
fi

for arg in "$@"; do
  mv "$arg" "$trash_dir/"
done
